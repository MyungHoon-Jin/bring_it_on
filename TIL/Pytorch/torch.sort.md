# `torch.sort`

```python
import torch

print(x)
>>> tensor([[ 0, 23, 14, 22, 18, 13,  3, 29,  1,  1,  1,  1,  1,  1,  1],
>>>         [ 0, 14,  8, 22, 14, 10, 20, 11, 25, 25, 23, 14,  9, 18, 29],
>>>         [ 0,  2, 14, 10, 23, 16, 25,  6, 22, 26, 10, 29,  1,  1,  1],
>>>         [ 0, 27,  7, 11,  5, 26, 19, 16, 12, 20, 13, 29,  1,  1,  1],
>>>         [ 0, 13, 27, 10, 24, 14, 24,  3, 20, 26, 14,  5,  3,  9, 29]])

x_lengths = (x != 1).sum(dim=1) # 1 is pad token
x_lengths
>>> tensor([ 8, 15, 12, 12, 15])

_, ind = torch.sort(x_lengths, descending=True)
ind
>>> tensor([1, 4, 2, 3, 0])

sorted_x = x.index_select(0, ind) # it is same to `x[ind]`
sorted_x
>>> tensor([[ 0, 14,  8, 22, 14, 10, 20, 11, 25, 25, 23, 14,  9, 18, 29],
>>>         [ 0, 13, 27, 10, 24, 14, 24,  3, 20, 26, 14,  5,  3,  9, 29],
>>>         [ 0,  2, 14, 10, 23, 16, 25,  6, 22, 26, 10, 29,  1,  1,  1],
>>>         [ 0, 27,  7, 11,  5, 26, 19, 16, 12, 20, 13, 29,  1,  1,  1],
>>>         [ 0, 23, 14, 22, 18, 13,  3, 29,  1,  1,  1,  1,  1,  1,  1]])

_, rev_ind = torch.sort(ind)
rev_ind
>>> tensor([4, 0, 2, 3, 1])

restored_x = sorted_x.index_select(0, rev_ind)
restored_x # it is same to `x`
>>> tensor([[ 0, 23, 14, 22, 18, 13,  3, 29,  1,  1,  1,  1,  1,  1,  1],
>>>         [ 0, 14,  8, 22, 14, 10, 20, 11, 25, 25, 23, 14,  9, 18, 29],
>>>         [ 0,  2, 14, 10, 23, 16, 25,  6, 22, 26, 10, 29,  1,  1,  1],
>>>         [ 0, 27,  7, 11,  5, 26, 19, 16, 12, 20, 13, 29,  1,  1,  1],
>>>         [ 0, 13, 27, 10, 24, 14, 24,  3, 20, 26, 14,  5,  3,  9, 29]])
```
